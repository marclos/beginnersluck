---
title: "Settler Ecology in Ecology Journals"
author: "Marc Los Huertos"
date: "4/4/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(jsonlite)
library(rtweet)
library(stringr)
```

## Method Resources

Starting this project required a bit of some stages that I hadn't anticipated...

<https://towardsdatascience.com/a-light-introduction-to-text-analysis-in-r-ea291a9865a8>.

### Large Files to Deal with

The files from constallate ore huge -- >1 GB and require to be uncompressed then to read jsonl files into R. Getting to this stage too several days. 

### Read jsonl Data

This is not as easy as one might think. First, there is a difference between json and jsonl, where l (lines) includes a dataset of ``observations'', which are contained in each line. 

I don't really know why, but when getting to be large in size are really not read by R very well. In fact, I have had a process to read a large file using jsonlite::stream_in and it has been running for 1:15:37:00, one day + 15 hours and it might take many more days. I think coverting to a data frame is a disaster and terribly ineffecient. 



### Convert jsonl to csv files

The 



## Analysis

### Read and Clean CSV
```{r}
setwd("/home/CAMPUS/mwl04747/github/beginnersluck/settler_ecology/data")

files = dir(pattern = "*.csv$")
all_journals = data.frame(datePublished=NA, isPartOf=NA,      abstract=NA, fullText=NA, id=NA)
for (i in 1:length(files)){
  temp = read.csv(files[i])
  all_journals = rbind(temp, all_journals)
}

head(all_journals)
```


### Clean Files

Removing hyphenated words
```{r}
all_journals$fullText = gsub("-\\s*", "", all_journals$fullText)
all_journals$abstract = gsub("-\\s*", "", all_journals$abstract)
all_journals$Date = as.Date(all_journals$datePublished)

```

## Are Native People Referenced?

### The Problem Associated with 'Indian'

Unfortunately, for all the early history in the sciences, few ecologists bothered to think critically about the terminology used in ecology with respect to the ``American Indian'', native peoples or nations of the USA, or even the terminology that they might want to be referred. 

Thus, doing a textual analysis is quite problematic. 

```{r}
# BotGaz %>% count(fullText, sort = TRUE)

sum(+(grepl("American Indian", all_journals$fullText)))

all_journals$AmIndian = +(grepl("American Indian", all_journals$fullText) | grepl("American Indian", all_journals$abstract));

sum(all_journals$AmIndian)
all_journals[all_journals$AmIndian==1, c(3,4)]


sum(+(grepl("Indian", all_journals$fullText)))

all_journals$Indian = +(grepl("Indian\\b", all_journals$fullText) &
                  !grepl("India\\b", all_journals$fullText) &
                  !grepl("West Indian", all_journals$fullText) &
                  !grepl("East Indian", all_journals$fullText) ); 
sum(all_journals$Indian)
str(all_journals)
plot(Indian~Date, all_journals)
#BotGaz.r1 = BotGaz[BotGaz$all_journals==1,c(1,2)]
#print(BotGaz.r1$fullText)

```

All of the references refer to Indian as a reference to the West or East Indian islands or to the Indian subcontinent. 

References to the ``American Indian'' is virtually absent. 

### Native Peoples vs. Native Species/Vegetation/etc


```{r}
BotGaz$Native = +(grepl("Native", BotGaz$fullText))

print(BotGaz$fullText[BotGaz$Native==1])
      
```


```{r}
arun <- function(keyword, str) {
    #keyword <- "Native"
    lookaround <- 3
    pattern <- paste0("([[:alpha:]]+ ){0,", lookaround, "}", keyword, 
                    "( [[:alpha:]]+){0,", lookaround, "}")

regmatches(str, regexpr(pattern, str))
}

arun("Native", BotGaz$fullText)
arun("native", BotGaz$fullText)

```

### Indigenous Peoples

```{r indigenous}
arun("indigenous", BotGaz$fullText)

plot(indigenous~datePublished, BotGaz)

```

### Tribes and Nations vs. Nationalitity and Tribes

<https://www.familysearch.org/en/wiki/Indigenous_Tribes_of_the_United_States>

plus others... 

Ohlone 
Costanoan

```{r, eval=FALSE}
BotGaz$native = +(grepl("native", BotGaz$fullText))
BotGaz$indigenous = +(grepl("indigenous", ignore.case = TRUE, BotGaz$fullText))

arun("tribe", BotGaz$fullText)
sum(BotGaz$indigenous)
head(BotGaz[order(BotGaz$Native, decreasing=T),])
head(BotGaz[order(BotGaz$indigenous, decreasing=T),])


```


### Specific Tribe/Nation References

```{r}
BotGaz$dine = +(grepl("Dine", BotGaz$fullText))

sum(BotGaz$dine) #Dineuron

print(BotGaz$fullText[BotGaz$dine==1])

arun("Cherokee", BotGaz$fullText)
arun("Pima", BotGaz$fullText)
arun("Dine", BotGaz$fullText)
arun("Apache", BotGaz$fullText)
arun("Yakama", BotGaz$fullText)
arun("Paiute", BotGaz$fullText)

```


### Other References to Land Management Orgs
```{r}
arun("Park", BotGaz$fullText)
arun("City", BotGaz$fullText)
```

## Acknowledgements

### Access to Sites/Resources

```{r}
arun("acknowledge", BotGaz$fullText)
```

### Land Management

Good ecologists should be referencing and framing the management of the landscape by residents current and historical, if it's relevant. Without a doubt, there may times that these are not relevant. 

## Unceded Lands
```{r}
arun("unceded", BotGaz$fullText)
```